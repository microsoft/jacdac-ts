## DOM

The DOM module is a depenency-free JavaScript object module 
that reflects the state of the JACDAC elements:

> A JACDAC **[bus](/clients/web/dom/bus)** is made of connected devices.
A **[device](/clients/web/dom/device)** hosts **services**.
A **[service](/clients/web/dom/service)** has **registers**, accept **commands**
and may return **acks**. A **[register](/clients/web/dom/register)** is an addressed data location
on a service, that may be get, set or streamed.

All element implement a event emitter and observable pattern to
easily data-bind them in a variety of UI frameworks.

### Setup

Install the ``jacdac-ts`` npm package (see full [setup instructions](/clients/web/setup)).

```
npm install --save-dev jacdac-ts
```

### Connect to the bus

You will need to connect to the JACDAC bus via WebUSB. 
This needs to be done from a user action, like a click,
for security reasons.

```javascript
import { createUSBBus } from "jacdac"

const jd = createUSBBus();
await jd.connectAsync();
```

### Devices

Once you have the bus connected, you can register to events when device get connected or disconnected.

```javascript
import { DEVICE_CONNECT, DEVICE_ANNOUNCE, DEVICE_DISCONNECT } from "jacdac"

jd.on(DEVICE_CONNECT, dev => console.log(`connect ${dev}`)
jd.on(DEVICE_ANNOUNCE, dev => console.log(`disconnect ${dev}`)
jd.on(DEVICE_DISCONNECT, dev => console.log(`announce ${dev}`)
jd.on(DEVICE_CHANGE, dev => console.log(`change ${dev}`)
```

Remember that when a device is first connected, it's list of services might not yet be populated. 
This happens later on the ``deviceannounce`` event.

You can get a snapshot of the list of devices from the bus.

```javascript
const devices = jd.devices()
```

See [tools](/tools) for example of vanilla HTML/JavaScript pages using the library.
